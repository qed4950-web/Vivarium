# 🤖 스마트 가드닝 AIoT

## **모델 학습 및 성능 향상 가이드라인 (Training & Optimization Guideline)**

Roboflow → YOLO11/YOLOv8 학습 → 성능 개선 → 배포까지 전부 포함

---

# 🎯 1. 목적

스마트 가드닝용 비전 모델을 **짧은 시간 안에 높은 정확도**로 만들기 위한
학습 설정과 성능 최적화 기준을 제공한다.

대상 모델:

* YOLO11n / YOLO11s
* YOLOv8n / YOLOv8s
* (Edge 환경 고려해서 small 계열 중심)

---

# 🚀 2. Roboflow Train 기능 사용 여부

Roboflow의 "Train" 버튼을 써도 되지만:

### ✔ 초보자 → Roboflow Train 추천

* 클릭 한 번
* 학습/검증/추론 모두 자동
* GPU 비용 저렴
* 바로 API로 Inference 가능

### ✔ 전문가 or 로컬 추론 예정 → Python 직접 학습 추천

* ONNX export 가능
* Raspberry Pi / Jetson 등 edge 배포 용이
* 모델 튜닝 자유도 높음

둘 다 설명해줄게.

---

# 🔧 3. Roboflow Train으로 학습하는 방법

프로젝트 → `Train a Model`

### 추천 설정:

| 항목             | 추천값                |
| -------------- | ------------------ |
| Model          | YOLO11s or YOLOv8s |
| Epochs         | 100                |
| Batch Size     | Auto               |
| Input Size     | 640                |
| Optimizer      | AdamW              |
| Early Stopping | ON                 |
| Learning Rate  | Auto               |

### 왜 이 설정이 좋은가?

* 식물 병해·벌레는 작은 객체 → YOLO11s가 sensitivity 좋음
* 100 epoch은 과적합 없이 충분한 학습량
* 640 해상도는 속도+정확도 가장 균형 좋음

---

# 💻 4. 직접 Python으로 학습(더 전문가용)

### Install

```bash
pip install ultralytics
```

### Train Code

```python
from ultralytics import YOLO

model = YOLO("yolo11s.pt")   # or yolo8s.pt

model.train(
    data="data.yaml",        # Roboflow에서 제공
    imgsz=640,
    epochs=100,
    batch=16,
    optimizer="AdamW",
    device=0,                # GPU
    lr0=0.001,
    augment=True
)
```

---

# 📈 5. 성능 높이는 핵심 전략

---

## 🔥 1) Small object(병반/벌레) 성능 높이기 — 매우 중요

### ✔ Tiling ON

640 Tile + 20~25% overlap

### ✔ Mosaic Augmentation OFF

병해는 타일 기반 작은 패턴이 중요 → Mosaic OFF 권장

### ✔ 이미지 해상도 1024로 높이기(선택)

작은 객체 정밀도 향상됨
다만 inference 속도 ↓

---

## 🔥 2) Class Balance 맞추기

Roboflow Health Check → Class 분포 확인

* 클래스가 1:10 이상 차이나면 under-represented class의 이미지 추가
* 특히

  * leaf_spot
  * brown_spot
  * aphid
    클래스는 부족해지기 쉬움 → 20~30장 더 확보 권장

---

## 🔥 3) Validation 데이터 충분히 확보

전체 이미지 기준:

* Train: 70%
* Valid: 20%
* Test: 10%

Validation이 부족하면 실제 성능이 과대평가됨.

---

## 🔥 4) 배경 다양성 확보

식물 뒤 배경:

* 벽
* 책상
* 선반
* 커뮤니티 가드닝
* 흙
* 실내조명
* 자연광

이 다양성을 확보해야,
실제 서비스 환경에서 인식률 ↑

---

## 🔥 5) Annotation Heatmap 고르게 만들기

Roboflow Health → Annotation Heatmap 확인
한쪽 구역에만 박스 몰리면 모델 편향됨.

예:

* 잎 점이 늘 “왼쪽 상단”에만 있음 → 잘못 학습

→ 촬영 각도 다양화

---

# 🧪 6. 모델 평가(Evaluation)

### 주요 지표:

```
mAP50
mAP50-95
precision
recall
```

### 기준 점수(목표):

* plant_species: mAP50 **95% 이상**
* plant_health: mAP50 **85% 이상**
* plant_disease: mAP50 **75% 이상**
* plant_pests: mAP50 **70% 이상** (작은 객체라 낮음)

---

# 📤 7. 모델 Export / Deployment

### Roboflow Train 사용 시

* 바로 Web API 호출 가능
* Python/JavaScript SDK 제공
* 로컬 ONNX 파일 다운로드 가능

### YOLOv8/11 사용 시

```bash
yolo export model=best.pt format=onnx
```

ONNX 모델은:

* Python Edge
* Raspberry Pi
* Jetson Nano
* Electron + Python

등에서 실시간 사용 가능.

---

# 🏎 8. 실시간 추론(FPS) 최적화 팁

* YOLO11n or YOLO8n 모델 사용 → FPS↑
* tile 크기 줄이기
* Crop 영역 지정 (화분만 추출)
* 이미지 해상도 320 테스트
* GPU 있으면 FP16으로 변환

---

# 🚀 9. 다음 단계

이제 모델 학습이 끝났으니,
다음은 **Python 추론 서버 가이드라인**으로 넘어간다.

📄 다음 파일: **05_1 모델_스마트가드닝 aiot로보플로우 비전가이드.md**

